# ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

## ğŸ¯ å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆçš„åŠŸèƒ½
- åŸºç¡€æ¶æ„ï¼ˆæˆ¿é—´ç³»ç»Ÿã€å®æ—¶åŒæ­¥ï¼‰
- æ¸¸æˆåˆå§‹åŒ–ï¼ˆå‘ç‰Œã€æ´—ç‰Œï¼‰
- æ‰‹ç‰Œç®¡ç†ï¼ˆæ’åºã€é€‰æ‹©ã€æ˜¾ç¤ºï¼‰
- å›åˆç³»ç»Ÿï¼ˆå›åˆåˆ‡æ¢ã€é¦–å›åˆå¤„ç†ï¼‰
- æ ¸å¿ƒç©æ³•ï¼ˆæ‘¸ç‰Œã€å‡ºç‰Œã€Næ¢Nã€Mæ¢Mã€æ¸…åœºï¼‰
- ç‰Œå‹åˆ¤å®šç³»ç»Ÿï¼ˆåŒèŠ±è‰²ã€åˆ†æ•°è®¡ç®—ï¼‰
- æ‰£ç‰Œç³»ç»Ÿï¼ˆæ¡ä»¶éªŒè¯ã€çŠ¶æ€åˆ‡æ¢ï¼‰
- **ç»“æŸå“åº”é˜¶æ®µï¼ˆæ‰£ç‰Œ â†’ å“åº” â†’ çŠ¶æ€æ”¶é›†ï¼‰** âœ¨ æœ€æ–°å®Œæˆ
- **çŠ¶æ€åŒæ­¥ä¿®å¤ï¼ˆåŸå­æ€§æŸ¥è¯¢ã€é˜²å¾¡æ€§éªŒè¯ï¼‰** âœ¨ æœ€æ–°å®Œæˆ

### âŒ å½“å‰ç¼ºå¤±çš„åŠŸèƒ½
- **æ¯”ç‰Œä¸ç»“ç®—ç³»ç»Ÿ**ï¼ˆæ¸¸æˆå¡åœ¨è¿™é‡Œ ğŸ”´ï¼‰
- äº®ç‰Œå±•ç¤º
- å¤šå±€æ¸¸æˆæ”¯æŒ
- ç›®æ ‡åˆ†è®¾ç½®
- ç‰¹æ®Šè§„åˆ™å¤„ç†

---

## ğŸš€ ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šæ¯”ç‰Œä¸ç»“ç®—ç³»ç»Ÿï¼ˆæ ¸å¿ƒé˜»å¡ï¼‰

**ç›®æ ‡ï¼š** è®©æ¸¸æˆèƒ½å¤Ÿå®Œæ•´è¿è¡Œä¸€å±€ï¼Œä»æ‰£ç‰Œåˆ°ç»“ç®—åˆ°é‡æ–°å¼€å§‹

**å½“å‰é—®é¢˜ï¼š**
- æ‰€æœ‰ç©å®¶å“åº”å®Œæ¯•åï¼Œæ¸¸æˆåœåœ¨ `phase: 'revealing'`
- æ²¡æœ‰äº®ç‰Œç•Œé¢
- æ²¡æœ‰æ¯”ç‰Œé€»è¾‘
- æ²¡æœ‰ç»“ç®—è®¡ç®—
- æ— æ³•è¿›å…¥ä¸‹ä¸€å±€

### ğŸ“‹ éœ€è¦å®ç°çš„åŠŸèƒ½æ¸…å•

#### 1. æ¯”ç‰Œç®—æ³•ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰â­â­â­

**æ–‡ä»¶ï¼š** `src/utils/compareHands.js`ï¼ˆæ–°å»ºï¼‰

**åŠŸèƒ½ï¼š**
- ä¸‰çº§æ¯”ç‰Œç®—æ³•
  - ç¬¬ä¸€çº§ï¼šæ¯”æ‰‹ç‰Œæ€»åˆ†ï¼ˆé«˜è€…èƒœï¼‰
  - ç¬¬äºŒçº§ï¼šæ¯”èŠ±è‰²ç­‰çº§ï¼ˆé»‘æ¡ƒ > çº¢æ¡ƒ > æ¢…èŠ± > æ–¹å—ï¼‰
  - ç¬¬ä¸‰çº§ï¼šæ¯”å•å¼ æœ€å¤§ç‰Œï¼ˆé€å¼ æ¯”è¾ƒï¼‰
  - ç‰¹æ®Šï¼šå®Œå…¨ç›¸åŒæ—¶æ‰£ç‰Œè€…è·èƒœ

**æ ¸å¿ƒå‡½æ•°ï¼š**
```javascript
/**
 * æ¯”è¾ƒä¸¤ä¸ªæ‰‹ç‰Œ
 * @param {Object} hand1 - ç©å®¶1çš„è¯„ä¼°ç»“æœ
 * @param {Object} hand2 - ç©å®¶2çš„è¯„ä¼°ç»“æœ
 * @param {string} knockerId - æ‰£ç‰Œè€…IDï¼ˆå¹³å±€åˆ¤å®šç”¨ï¼‰
 * @returns {number} 1: hand1èƒœ, -1: hand2èƒœ, 0: å¹³å±€
 */
export const compareHands = (hand1, hand2, knockerId) => {
  // ç¬¬ä¸€çº§ï¼šæ¯”åˆ†æ•°
  if (hand1.handScore !== hand2.handScore) {
    return hand1.handScore > hand2.handScore ? 1 : -1
  }
  
  // ç¬¬äºŒçº§ï¼šæ¯”èŠ±è‰²
  const suitRank = { spades: 4, hearts: 3, clubs: 2, diamonds: 1 }
  if (hand1.suit !== hand2.suit) {
    return suitRank[hand1.suit] > suitRank[hand2.suit] ? 1 : -1
  }
  
  // ç¬¬ä¸‰çº§ï¼šæ¯”å•å¼ 
  // ... å®ç°é€å¼ æ¯”è¾ƒé€»è¾‘
  
  // å®Œå…¨ç›¸åŒï¼šæ‰£ç‰Œè€…è·èƒœ
  if (hand1.playerId === knockerId) return 1
  if (hand2.playerId === knockerId) return -1
  
  return 0
}
```

**å®æ–½æ­¥éª¤ï¼š**
1. åˆ›å»º `src/utils/compareHands.js`
2. å®ç°ä¸‰çº§æ¯”ç‰Œç®—æ³•
3. æ·»åŠ å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
4. å¯¼å‡ºç»™ç»“ç®—ç³»ç»Ÿä½¿ç”¨

**é¢„è®¡æ—¶é—´ï¼š** 2-3å°æ—¶

---

#### 2. ç»“ç®—é€»è¾‘ï¼ˆgameStore.jsï¼‰â­â­â­

**æ–°å¢æ–¹æ³•ï¼š**

##### 2.1 `performSettlement()` - æ‰§è¡Œç»“ç®—
```javascript
performSettlement: async () => {
  const { game, players } = get()
  
  // 1. è·å–æ‰€æœ‰å“åº”æ•°æ®
  const responses = game.game_state.showdown_responses
  
  // 2. æ„å»ºç«äº‰æ± ï¼ˆåªæœ‰ç ¸çš„ç©å®¶å‚ä¸æ¯”ç‰Œï¼‰
  const competitors = []
  const folders = []
  
  players.forEach(player => {
    const response = responses[player.id]
    if (!response) return
    
    if (response.action === 'knock' || response.action === 'call') {
      // æ£€æŸ¥æ˜¯å¦ä¸ºéº»å­
      if (!response.is_mazi) {
        competitors.push({
          playerId: player.id,
          nickname: player.nickname,
          evaluation: response.evaluation,
          hand: response.hand_snapshot
        })
      }
    } else {
      folders.push(player.id)
    }
  })
  
  // 3. æ¯”ç‰Œç¡®å®šèƒœè´Ÿ
  const winner = determineWinner(competitors, game.game_state.knocker_id)
  
  // 4. è®¡ç®—å¾—åˆ†
  const scores = calculateScores(
    players, 
    responses, 
    winner, 
    game.game_state.target_score
  )
  
  // 5. æ›´æ–°æ•°æ®åº“
  await updateSettlement(game.id, scores, winner)
  
  // 6. åˆ‡æ¢åˆ°ç»“ç®—å±•ç¤ºé˜¶æ®µ
  set({ game: { ...game, status: GAME_STATUS.FINISHED } })
}
```

##### 2.2 `determineWinner()` - ç¡®å®šèµ¢å®¶
```javascript
const determineWinner = (competitors, knockerId) => {
  if (competitors.length === 0) {
    // æ‰€æœ‰äººéƒ½éšï¼Œæ‰£ç‰Œè€…ç‹¬èµ¢
    return knockerId
  }
  
  if (competitors.length === 1) {
    // åªæœ‰ä¸€ä¸ªäººå‚ä¸æ¯”ç‰Œ
    return competitors[0].playerId
  }
  
  // å¤šäººæ¯”ç‰Œï¼šä¸¤ä¸¤æ¯”è¾ƒæ‰¾å‡ºæœ€å¤§è€…
  let currentWinner = competitors[0]
  
  for (let i = 1; i < competitors.length; i++) {
    const result = compareHands(
      currentWinner.evaluation, 
      competitors[i].evaluation,
      knockerId
    )
    
    if (result < 0) {
      currentWinner = competitors[i]
    }
  }
  
  return currentWinner.playerId
}
```

##### 2.3 `calculateScores()` - è®¡ç®—å¾—åˆ†
```javascript
const calculateScores = (players, responses, winnerId, targetScore) => {
  const scores = {}
  
  players.forEach(player => {
    const response = responses[player.id]
    if (!response) {
      scores[player.id] = 0
      return
    }
    
    // èµ¢å®¶å¾—åˆ†
    if (player.id === winnerId) {
      const baseScore = response.evaluation.handScore - targetScore
      
      // ç»Ÿè®¡æœ‰å¤šå°‘äººç ¸äº†ï¼ˆè¾“å®¶ï¼‰
      const losersCount = players.filter(p => {
        const r = responses[p.id]
        return r && r.action === 'call' && p.id !== winnerId
      }).length
      
      scores[player.id] = baseScore * (1 + losersCount)
    }
    // éº»å­æ‰£åˆ†
    else if (response.is_mazi && response.action !== 'fold') {
      scores[player.id] = -targetScore
    }
    // éšçš„ç©å®¶ä¸å¾—åˆ†
    else if (response.action === 'fold') {
      scores[player.id] = 0
    }
    // ç ¸äº†ä½†è¾“äº†
    else if (response.action === 'call') {
      const winnerResponse = responses[winnerId]
      const winnerBaseScore = winnerResponse.evaluation.handScore - targetScore
      scores[player.id] = -winnerBaseScore
    }
    // å…¶ä»–æƒ…å†µ
    else {
      scores[player.id] = 0
    }
  })
  
  return scores
}
```

**å®æ–½æ­¥éª¤ï¼š**
1. åœ¨ `gameStore.js` ä¸­æ·»åŠ ç»“ç®—ç›¸å…³æ–¹æ³•
2. å¯¼å…¥ `compareHands` å‡½æ•°
3. å®ç°ç»“ç®—æµç¨‹
4. æµ‹è¯•å„ç§ç»“ç®—åœºæ™¯

**é¢„è®¡æ—¶é—´ï¼š** 3-4å°æ—¶

---

#### 3. ç»“ç®—ç•Œé¢ï¼ˆSettlementModal.jsxï¼‰â­â­

**æ–‡ä»¶ï¼š** `src/components/SettlementModal.jsx` + `.css`ï¼ˆæ–°å»ºï¼‰

**åŠŸèƒ½ï¼š**
- æ˜¾ç¤ºæ‰€æœ‰ç©å®¶çš„æ‰‹ç‰Œï¼ˆäº®ç‰Œï¼‰
- æ˜¾ç¤ºæ¯ä¸ªç©å®¶çš„ç‰Œå‹è¯„ä¼°
- é«˜äº®æ˜¾ç¤ºèµ¢å®¶
- æ˜¾ç¤ºæ¯ä¸ªç©å®¶çš„å¾—åˆ†/å¤±åˆ†
- "ä¸‹ä¸€å±€"æŒ‰é’®

**UI è®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ğŸ‰ æœ¬å±€ç»“ç®—                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘‘ èµ¢å®¶ï¼šè½½å®¶æ€                         â”‚
â”‚  å¾—åˆ†ï¼š+15 åˆ†                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç©å®¶      æ‰‹ç‰Œ         ç‰Œå‹      å¾—åˆ†   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  è½½å®¶æ€   [Aâ™ Kâ™ Qâ™ Jâ™ 10â™ ]  é»‘æ¡ƒåŒèŠ±  +15  â”‚
â”‚  ä¹ä¹æ¬§   [Kâ™¥Qâ™¥Jâ™¥10â™¥9â™¥]  çº¢æ¡ƒåŒèŠ±  -5   â”‚
â”‚  åˆ©æˆæ©   [8â™¦7â™¦6â™¦5â™¦4â™¦]   éº»å­      0    â”‚
â”‚  é™ˆå˜‰ç‘   [9â™£8â™£7â™£6â™£5â™£]   æ¢…èŠ±åŒèŠ±  -5   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ ä¸‹ä¸€å±€ ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»„ä»¶ç»“æ„ï¼š**
```jsx
export default function SettlementModal({ 
  players, 
  responses, 
  winner, 
  scores,
  onNextRound 
}) {
  return (
    <div className="settlement-modal-overlay">
      <div className="settlement-modal">
        <h2 className="settlement-title">ğŸ‰ æœ¬å±€ç»“ç®—</h2>
        
        <div className="winner-section">
          <div className="winner-badge">ğŸ‘‘ èµ¢å®¶</div>
          <div className="winner-name">{winner.nickname}</div>
          <div className="winner-score">+{scores[winner.id]} åˆ†</div>
        </div>
        
        <div className="settlement-table">
          {players.map(player => (
            <div key={player.id} className={`player-row ${player.id === winner.id ? 'winner' : ''}`}>
              <div className="player-name">{player.nickname}</div>
              <div className="player-hand">
                {responses[player.id].hand_snapshot.map(card => (
                  <Card card={card} small />
                ))}
              </div>
              <div className="player-type">
                {responses[player.id].evaluation.suit ? 
                  `${SUIT_DISPLAY[responses[player.id].evaluation.suit].name}åŒèŠ±` : 
                  'éº»å­'}
              </div>
              <div className={`player-score ${scores[player.id] > 0 ? 'positive' : scores[player.id] < 0 ? 'negative' : 'neutral'}`}>
                {scores[player.id] > 0 ? '+' : ''}{scores[player.id]}
              </div>
            </div>
          ))}
        </div>
        
        <button className="btn-next-round" onClick={onNextRound}>
          ä¸‹ä¸€å±€
        </button>
      </div>
    </div>
  )
}
```

**å®æ–½æ­¥éª¤ï¼š**
1. åˆ›å»º `SettlementModal` ç»„ä»¶
2. è®¾è®¡ç»“ç®—ç•Œé¢æ ·å¼
3. åœ¨ `GameRoom` ä¸­é›†æˆ
4. å¤„ç†"ä¸‹ä¸€å±€"é€»è¾‘

**é¢„è®¡æ—¶é—´ï¼š** 2-3å°æ—¶

---

#### 4. é›†æˆåˆ° GameRoomï¼ˆè¿æ¥æ‰€æœ‰éƒ¨åˆ†ï¼‰â­â­

**ä¿®æ”¹æ–‡ä»¶ï¼š** `src/components/GameRoom.jsx`

**éœ€è¦æ·»åŠ ï¼š**

1. **æ£€æµ‹ revealing é˜¶æ®µï¼Œè‡ªåŠ¨è§¦å‘ç»“ç®—**
```javascript
useEffect(() => {
  if (game?.game_state?.phase === 'revealing' && 
      game?.game_state?.all_responded) {
    // å»¶è¿Ÿ1ç§’åæ‰§è¡Œç»“ç®—ï¼Œè®©ç©å®¶çœ‹åˆ°æœ€åä¸€ä¸ªå“åº”
    setTimeout(() => {
      performSettlement()
    }, 1000)
  }
}, [game?.game_state?.phase, game?.game_state?.all_responded])
```

2. **æ¸²æŸ“ç»“ç®—ç•Œé¢**
```javascript
// åœ¨ GameRoom ç»„ä»¶çš„è¿”å›ä¸­æ·»åŠ 
{game?.status === GAME_STATUS.FINISHED && settlementData && (
  <SettlementModal 
    players={players}
    responses={game.game_state.showdown_responses}
    winner={settlementData.winner}
    scores={settlementData.scores}
    onNextRound={handleNextRound}
  />
)}
```

3. **å¤„ç†ä¸‹ä¸€å±€é€»è¾‘**
```javascript
const handleNextRound = async () => {
  // é‡ç½®æ¸¸æˆçŠ¶æ€
  await resetGameForNextRound()
}
```

**å®æ–½æ­¥éª¤ï¼š**
1. å¯¼å…¥ `SettlementModal` å’Œ `performSettlement`
2. æ·»åŠ è‡ªåŠ¨ç»“ç®—è§¦å‘é€»è¾‘
3. å¤„ç†ç»“ç®—ç•Œé¢æ˜¾ç¤º
4. å®ç°"ä¸‹ä¸€å±€"æŒ‰é’®é€»è¾‘

**é¢„è®¡æ—¶é—´ï¼š** 1-2å°æ—¶

---

### ğŸ“Š æ€»ä½“å®æ–½è®¡åˆ’

#### é˜¶æ®µ1ï¼šæ ¸å¿ƒç®—æ³•ï¼ˆç¬¬1å¤©ä¸Šåˆï¼‰
- [ ] åˆ›å»º `compareHands.js`
- [ ] å®ç°ä¸‰çº§æ¯”ç‰Œç®—æ³•
- [ ] æµ‹è¯•å„ç§æ¯”ç‰Œåœºæ™¯

#### é˜¶æ®µ2ï¼šç»“ç®—é€»è¾‘ï¼ˆç¬¬1å¤©ä¸‹åˆï¼‰
- [ ] åœ¨ `gameStore.js` ä¸­æ·»åŠ ç»“ç®—æ–¹æ³•
- [ ] å®ç° `performSettlement()`
- [ ] å®ç° `determineWinner()`
- [ ] å®ç° `calculateScores()`
- [ ] æµ‹è¯•ç»“ç®—é€»è¾‘

#### é˜¶æ®µ3ï¼šç»“ç®—ç•Œé¢ï¼ˆç¬¬2å¤©ä¸Šåˆï¼‰
- [ ] åˆ›å»º `SettlementModal` ç»„ä»¶
- [ ] è®¾è®¡ç»“ç®—ç•Œé¢æ ·å¼
- [ ] å®ç°æ‰‹ç‰Œå±•ç¤º
- [ ] æ·»åŠ åŠ¨ç”»æ•ˆæœ

#### é˜¶æ®µ4ï¼šé›†æˆæµ‹è¯•ï¼ˆç¬¬2å¤©ä¸‹åˆï¼‰
- [ ] é›†æˆåˆ° `GameRoom`
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•å®Œæ•´æµç¨‹
- [ ] ä¿®å¤ bug
- [ ] ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

**æ€»é¢„è®¡æ—¶é—´ï¼š** 1.5-2å¤©

---

## ğŸ¯ æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•åœºæ™¯1ï¼šæ­£å¸¸æ¯”ç‰Œ
- ç©å®¶Aæ‰£ç‰Œï¼ˆé»‘æ¡ƒåŒèŠ±ï¼Œ48åˆ†ï¼‰
- ç©å®¶Bç ¸ï¼ˆçº¢æ¡ƒåŒèŠ±ï¼Œ45åˆ†ï¼‰
- ç©å®¶Céš
- ç©å®¶Dç ¸ï¼ˆæ¢…èŠ±åŒèŠ±ï¼Œ42åˆ†ï¼‰

**é¢„æœŸç»“æœï¼š**
- ç©å®¶Aè·èƒœ
- ç©å®¶Aå¾—åˆ†ï¼š8 * (1 + 2) = 24åˆ†
- ç©å®¶Bå¤±åˆ†ï¼š-8åˆ†
- ç©å®¶Cå¾—åˆ†ï¼š0åˆ†
- ç©å®¶Då¤±åˆ†ï¼š-8åˆ†

### æµ‹è¯•åœºæ™¯2ï¼šéº»å­æ‰£ç‰Œ
- ç©å®¶Aæ‰£ç‰Œï¼ˆä½†å®é™…æ˜¯éº»å­ï¼‰
- å…¶ä»–ç©å®¶ç ¸

**é¢„æœŸç»“æœï¼š**
- ç©å®¶Aæ‰£åˆ†ï¼š-40åˆ†
- å…¶ä»–ç©å®¶æ ¹æ®æ¯”ç‰Œç»“æœå¾—åˆ†

### æµ‹è¯•åœºæ™¯3ï¼šå…¨éƒ¨éš
- ç©å®¶Aæ‰£ç‰Œ
- æ‰€æœ‰äººéƒ½é€‰æ‹©éš

**é¢„æœŸç»“æœï¼š**
- ç©å®¶Aç‹¬èµ¢ï¼šå¾— 8 åˆ†
- å…¶ä»–äººï¼š0åˆ†

### æµ‹è¯•åœºæ™¯4ï¼šå¹³å±€
- ç©å®¶Aæ‰£ç‰Œï¼ˆé»‘æ¡ƒåŒèŠ±ï¼Œ48åˆ†ï¼‰
- ç©å®¶Bç ¸ï¼ˆé»‘æ¡ƒåŒèŠ±ï¼Œ48åˆ†ï¼Œæ‰‹ç‰Œå®Œå…¨ç›¸åŒï¼‰

**é¢„æœŸç»“æœï¼š**
- ç©å®¶Aè·èƒœï¼ˆæ‰£ç‰Œè€…ä¼˜å…ˆï¼‰
- æ­£å¸¸ç»“ç®—

---

## ğŸ“ˆ åç»­ä¼˜å…ˆçº§ï¼ˆå®Œæˆæ¯”ç‰Œç»“ç®—åï¼‰

### ç¬¬äºŒä¼˜å…ˆçº§ï¼šå¤šå±€æ¸¸æˆæ”¯æŒ
- [ ] ç§¯åˆ†ç³»ç»Ÿï¼ˆç´¯è®¡æ€»åˆ†ï¼‰
- [ ] ä¸‹ä¸€å±€å‡†å¤‡æœºåˆ¶
- [ ] ç¡®å®šä¸‹ä¸€å±€èµ·å§‹ç©å®¶ï¼ˆä¸Šå±€å¾—åˆ†æœ€ä½è€…ï¼‰
- [ ] ç§¯åˆ†æ’è¡Œæ¦œ

**é¢„è®¡æ—¶é—´ï¼š** 1å¤©

### ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šæ¸¸æˆé…ç½®
- [ ] ç›®æ ‡åˆ†è®¾ç½®ï¼ˆ40/45/50åˆ†å¯é€‰ï¼‰
- [ ] ç©å®¶äººæ•°é™åˆ¶
- [ ] æ¸¸æˆè§„åˆ™è¯´æ˜

**é¢„è®¡æ—¶é—´ï¼š** 0.5å¤©

### ç¬¬å››ä¼˜å…ˆçº§ï¼šç‰¹æ®Šè§„åˆ™
- [ ] ç‰Œå †è€—å°½å¤„ç†
- [ ] æ­»å±€æ£€æµ‹
- [ ] å¼ºåˆ¶ç»“ç®—

**é¢„è®¡æ—¶é—´ï¼š** 1å¤©

### ç¬¬äº”ä¼˜å…ˆçº§ï¼šUI/UXä¼˜åŒ–
- [ ] å‘ç‰ŒåŠ¨ç”»
- [ ] å‡ºç‰ŒåŠ¨ç”»
- [ ] æ¯”ç‰ŒåŠ¨ç”»
- [ ] éŸ³æ•ˆç³»ç»Ÿ
- [ ] ç§»åŠ¨ç«¯é€‚é…

**é¢„è®¡æ—¶é—´ï¼š** 2-3å¤©

---

## ğŸ’¡ æŠ€æœ¯å»ºè®®

### 1. çŠ¶æ€ç®¡ç†
ç»§ç»­ä½¿ç”¨å½“å‰çš„ Zustand + Supabase Realtime æ–¹æ¡ˆï¼Œå·²ç»éªŒè¯ç¨³å®šã€‚

### 2. ç»“ç®—æ•°æ®æŒä¹…åŒ–
è€ƒè™‘åœ¨ `game_state` ä¸­æ·»åŠ ï¼š
```javascript
{
  settlement: {
    winner_id: "uuid",
    scores: { "player-id": 10, ... },
    settled_at: "timestamp",
    round_number: 1
  }
}
```

### 3. å¤šå±€æ¸¸æˆæ•°æ®
å¯ä»¥åœ¨ `players` è¡¨çš„ `player_state` ä¸­è®°å½•ï¼š
```javascript
{
  total_score: 0,      // æ€»ç§¯åˆ†
  rounds_won: 0,       // è·èƒœå±€æ•°
  rounds_played: 0     // å‚ä¸å±€æ•°
}
```

### 4. æ€§èƒ½ä¼˜åŒ–
- ç»“ç®—è®¡ç®—åœ¨å®¢æˆ·ç«¯å®Œæˆï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›
- ä½¿ç”¨ Supabase RPC å‡½æ•°æ‰¹é‡æ›´æ–°ç©å®¶ç§¯åˆ†
- æ·»åŠ ç»“ç®—åŠ¨ç”»æ—¶æ³¨æ„å¸§ç‡

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

æ¯”ç‰Œä¸ç»“ç®—ç³»ç»Ÿå®Œæˆçš„æ ‡å¿—ï¼š
- âœ… æ‰€æœ‰ç©å®¶å“åº”å®Œæ¯•åè‡ªåŠ¨è¿›å…¥ç»“ç®—
- âœ… æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰ç©å®¶çš„æ‰‹ç‰Œ
- âœ… ä¸‰çº§æ¯”ç‰Œç®—æ³•è¿è¡Œæ­£ç¡®
- âœ… å¾—åˆ†è®¡ç®—å‡†ç¡®æ— è¯¯
- âœ… ç»“ç®—ç•Œé¢ç¾è§‚æ¸…æ™°
- âœ… å¯ä»¥é¡ºåˆ©è¿›å…¥ä¸‹ä¸€å±€
- âœ… å¤šå®¢æˆ·ç«¯ç»“ç®—ç»“æœä¸€è‡´

---

## ğŸ“ æ€»ç»“

**å½“å‰æœ€ç´§æ€¥çš„ä»»åŠ¡ï¼š** å®ç°æ¯”ç‰Œä¸ç»“ç®—ç³»ç»Ÿ

**é¢„è®¡å®Œæˆæ—¶é—´ï¼š** 1.5-2å¤©ï¼ˆçº¦10-15å°æ—¶ï¼‰

**å®Œæˆåæ•ˆæœï¼š**
- ğŸ‰ æ¸¸æˆæ ¸å¿ƒå¾ªç¯å®Œæ•´æ‰“é€š
- ğŸ‰ å¯ä»¥æ­£å¸¸è¿›è¡Œå¤šå±€æ¸¸æˆ
- ğŸ‰ ç©å®¶å¯ä»¥çœ‹åˆ°å®Œæ•´çš„æ¸¸æˆæµç¨‹

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼š**
1. ç«‹å³å¼€å§‹å®ç° `compareHands.js`
2. ç„¶åå®ç°ç»“ç®—é€»è¾‘
3. æœ€åæ·»åŠ ç»“ç®—ç•Œé¢
4. ç«¯åˆ°ç«¯æµ‹è¯•

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š** 2026-02-08  
**æœ€åæ›´æ–°ï¼š** 2026-02-08  
**çŠ¶æ€ï¼š** å¾…å®æ–½

ğŸš€ å‡†å¤‡å¼€å§‹äº†å—ï¼Ÿ
